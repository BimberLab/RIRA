<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Immune Cell Type/State Scoring • RIRA</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Immune Cell Type/State Scoring">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RIRA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/GetRira.html">Download RIRA</a></li>
    <li><a class="dropdown-item" href="../articles/CellType.html">Immune Cell Type/State Scoring</a></li>
    <li><a class="dropdown-item" href="../articles/TCellDifferentiation.html">T Cell Type/State Scoring</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Immune Cell Type/State Scoring</h1>
            
      

      <div class="d-none name"><code>CellType.Rmd</code></div>
    </div>

    
    
<p>This vignette provides examples on how to use the rhesus macaque cell
type scoring models generated and provided by RIRA. RIRA’s data was
generated and labeled using the following process:</p>
<ol style="list-style-type: decimal">
<li>Merge data from all animals (n=47). Perform strict QC and
filtration, based on metrics such as per-cell RNA saturation</li>
<li>For initial phenotyping, we used scGate with a set of rhesus-adapted
gates to divide cells. This initial pass is lossy, and will not label
all cells.</li>
<li>Cells labeled by scGate were downsampled to equalize cells per
class, and then fed as training data to celltypist. The resulting model
is available through this R package (see below)</li>
<li>This CellTypist model will classify cells into coarse bins (T/NK,
Bcell, Myeloid, and Other). For many analyses we find it useful to
subdivide a dataset into these categories and then perform
dimensionality reduction on these more homogenous subsets.</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bimberlab.github.io/RIRA/">RIRA</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat" class="external-link">Seurat</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span></code></pre></div>
<p>First download the data as a Seurat object (or use your own input
data):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seuratObj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DownloadFromGEO.html">DownloadFromGEO</a></span><span class="op">(</span>subset <span class="op">=</span> <span class="st">'All'</span>, outfile <span class="op">=</span> <span class="st">'RIRA_All.rds.gz'</span><span class="op">)</span></span></code></pre></div>
<p>Use the built-in celltypist model to score cells according to coarse
cell types (T/NK, Bcell, Myeloid, Other). The rationale for selecting
this level of classification is that these should be mutually exclusive
cell types and these cell types should robustly separate (i.e., other
factors that impact cell state should not cause collisions). After the
initial classification, it will also score cells for a panel of UCell
markers designed to identify incompatible cell types, such as T/NK cells
and Erythrocytes), which likely indicate doublets. See
FilterDisallowedClasses() for more detail.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seuratObj</span> <span class="op">&lt;-</span> <span class="fu">RIRA</span><span class="fu">::</span><span class="fu"><a href="../reference/Classify_ImmuneCells.html">Classify_ImmuneCells</a></span><span class="op">(</span><span class="va">seuratObj</span><span class="op">)</span></span>
<span><span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.org/seurat/reference/DimPlot.html" class="external-link">DimPlot</a></span><span class="op">(</span><span class="va">seuratObj</span>, group.by <span class="op">=</span> <span class="st">'RIRA_Immune_v2.cellclass'</span><span class="op">)</span></span></code></pre></div>
<p><img src="img%2FRIRA_UMAP.png" alt="UMAP plot of bulk immune colored based on cell type label" width="1050"></p>
<p>We also provide two specialist models designed for sub-typing within
T/NK cells and within Myeloid cells. While in our experience these
models are useful for automatic cell type/subtype scoring, it is
important to note that these are not perfect, and there are predictable
biological processes that cause cells of different lineages to have
highly similar transcriptomes (e.g., a highly cytotoxic T cell and an NK
cell, or highly cytotoxic TEM-like CD4+ T cells and cytotoxic CD8+ T
cells). These issues are explored in more detail in the RIRA
manuscript.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seuratObj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DownloadFromGEO.html">DownloadFromGEO</a></span><span class="op">(</span>subset <span class="op">=</span> <span class="st">'T_NK'</span>, outfile <span class="op">=</span> <span class="st">'RIRA_TNK.rds.gz'</span><span class="op">)</span></span>
<span><span class="va">seuratObj</span> <span class="op">&lt;-</span> <span class="fu">RIRA</span><span class="fu">::</span><span class="fu"><a href="../reference/Classify_TNK.html">Classify_TNK</a></span><span class="op">(</span><span class="va">seuratObj</span><span class="op">)</span></span>
<span><span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.org/seurat/reference/DimPlot.html" class="external-link">DimPlot</a></span><span class="op">(</span><span class="va">seuratObj</span>, group.by <span class="op">=</span> <span class="st">'RIRA_TNK_v2.cellclass'</span><span class="op">)</span></span></code></pre></div>
<p><img src="img%2FRIRA_UMAP_TNK.png" alt="UMAP plot of T/NK cells colored based on cell subtype label" width="1050"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seuratObj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DownloadFromGEO.html">DownloadFromGEO</a></span><span class="op">(</span>subset <span class="op">=</span> <span class="st">'Myeloid'</span>, outfile <span class="op">=</span> <span class="st">'RIRA_Myeloid.rds.gz'</span><span class="op">)</span></span>
<span><span class="va">seuratObj</span> <span class="op">&lt;-</span> <span class="fu">RIRA</span><span class="fu">::</span><span class="fu"><a href="../reference/Classify_Myeloid.html">Classify_Myeloid</a></span><span class="op">(</span><span class="va">seuratObj</span><span class="op">)</span></span>
<span><span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.org/seurat/reference/DimPlot.html" class="external-link">DimPlot</a></span><span class="op">(</span><span class="va">seuratObj</span>, group.by <span class="op">=</span> <span class="st">'RIRA_Myeloid_v3.cellclass'</span><span class="op">)</span></span></code></pre></div>
<p><img src="img%2FRIRA_UMAP_Myeloid.png" alt="UMAP plot of myeloid cells colored based on cell subtype label" width="1050"></p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bimber Lab.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
